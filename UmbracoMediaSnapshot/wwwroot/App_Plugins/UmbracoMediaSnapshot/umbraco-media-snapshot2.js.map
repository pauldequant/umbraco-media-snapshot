{"version":3,"file":"umbraco-media-snapshot2.js","sources":["../../../Client/src/snapshot-dashboard.ts"],"sourcesContent":["import { LitElement, html, css, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\nimport { UmbLocalizationController } from '@umbraco-cms/backoffice/localization-api';\r\nimport { UMB_AUTH_CONTEXT } from '@umbraco-cms/backoffice/auth';\r\n\r\ninterface FolderSummary {\r\n    folderName: string;\r\n    mediaKey: string | null;\r\n    mediaName: string | null;\r\n    snapshotCount: number;\r\n    totalSizeBytes: number;\r\n    totalSizeFormatted: string;\r\n    latestSnapshotDate: string | null;\r\n    oldestSnapshotDate: string | null;\r\n}\r\n\r\ninterface SettingsSummary {\r\n    maxSnapshotsPerMedia: number;\r\n    maxSnapshotAgeDays: number;\r\n    enableAutomaticCleanup: boolean;\r\n    sasTokenExpirationHours: number;\r\n    trackedMediaTypes: string[];\r\n}\r\n\r\ninterface StorageStats {\r\n    totalSnapshotCount: number;\r\n    totalSizeBytes: number;\r\n    totalSizeFormatted: string;\r\n    mediaItemCount: number;\r\n    topConsumers: FolderSummary[];\r\n    settings: SettingsSummary;\r\n}\r\n\r\n/**\r\n * Snapshot Storage Dashboard\r\n * Displays aggregated storage statistics for all media snapshots\r\n */\r\n@customElement('snapshot-dashboard')\r\nexport class SnapshotDashboardElement extends UmbElementMixin(LitElement) {\r\n\r\n    readonly #localize = new UmbLocalizationController(this);\r\n\r\n    /** Shorthand for localize.term with the package prefix */\r\n    #t(key: string): string {\r\n        return this.#localize.term(`umbracoMediaSnapshot_${key}`);\r\n    }\r\n\r\n    @state()\r\n    private _stats: StorageStats | null = null;\r\n\r\n    @state()\r\n    private _loading = true;\r\n\r\n    @state()\r\n    private _error = '';\r\n\r\n    private _authContext?: typeof UMB_AUTH_CONTEXT.TYPE;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.consumeContext(UMB_AUTH_CONTEXT, (instance) => {\r\n            this._authContext = instance;\r\n            this._fetchStats();\r\n        });\r\n    }\r\n\r\n    private async _fetchStats() {\r\n        this._loading = true;\r\n        this._error = '';\r\n\r\n        const token = await this._authContext?.getLatestToken();\r\n        if (!token) {\r\n            this._error = this.#t('noAuthToken');\r\n            this._loading = false;\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('/umbraco/management/api/v1/snapshot/storage-stats', {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            });\r\n\r\n            if (response.ok) {\r\n                this._stats = await response.json();\r\n            } else if (response.status === 401) {\r\n                this._error = this.#t('dashboardUnauthorized');\r\n            } else {\r\n                this._error = this.#t('dashboardLoadFailed');\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch storage stats:', error);\r\n            this._error = this.#t('dashboardLoadError');\r\n        } finally {\r\n            this._loading = false;\r\n        }\r\n    }\r\n\r\n    private _formatDate(dateString: string | null): string {\r\n        if (!dateString) return '—';\r\n        const date = new Date(dateString);\r\n        return date.toLocaleDateString(undefined, {\r\n            day: '2-digit',\r\n            month: 'short',\r\n            year: 'numeric',\r\n            hour: '2-digit',\r\n            minute: '2-digit'\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Renders the media folder cell — a clickable link if the media item\r\n     * was resolved, or a plain code label if it was not (e.g. orphaned folder)\r\n     */\r\n    private _renderFolderCell(folder: FolderSummary) {\r\n        if (folder.mediaKey) {\r\n            const href = `/umbraco/section/media/workspace/media/edit/${folder.mediaKey}`;\r\n            const displayName = folder.mediaName || folder.folderName;\r\n            return html`\r\n                <a class=\"media-link\" href=\"${href}\" title=\"${this.#t('dashboardOpenInEditor').replace('{0}', displayName)}\">\r\n                    <uui-icon name=\"icon-picture\"></uui-icon>\r\n                    <span class=\"media-link-name\">${displayName}</span>\r\n                    <code class=\"folder-name-sub\">${folder.folderName}</code>\r\n                </a>\r\n            `;\r\n        }\r\n\r\n        return html`\r\n            <span class=\"folder-unresolved\" title=\"${this.#t('dashboardOrphanedTitle')}\">\r\n                <code class=\"folder-name\">${folder.folderName}</code>\r\n                <uui-tag look=\"secondary\" color=\"warning\">${this.#t('dashboardOrphaned')}</uui-tag>\r\n            </span>\r\n        `;\r\n    }\r\n\r\n    render() {\r\n        if (this._loading) {\r\n            return html`\r\n                <div class=\"dashboard-loading\">\r\n                    <uui-loader></uui-loader>\r\n                    ${this.#t('dashboardLoading')}\r\n                </div>\r\n            `;\r\n        }\r\n\r\n        if (this._error) {\r\n            return html`\r\n                <uui-box>\r\n                    <div class=\"dashboard-error\">\r\n                        <uui-icon name=\"icon-alert\"></uui-icon>\r\n                        <span>${this._error}</span>\r\n                        <uui-button look=\"primary\" compact @click=\"${this._fetchStats}\">\r\n                            <uui-icon name=\"icon-refresh\"></uui-icon> ${this.#t('dashboardRetry')}\r\n                        </uui-button>\r\n                    </div>\r\n                </uui-box>\r\n            `;\r\n        }\r\n\r\n        const stats = this._stats!;\r\n        const hours = stats.settings.sasTokenExpirationHours;\r\n\r\n        return html`\r\n            <div class=\"dashboard\">\r\n                <!-- Header -->\r\n                <div class=\"dashboard-header\">\r\n                    <div>\r\n                        <h2>\r\n                            <uui-icon name=\"icon-history\"></uui-icon>\r\n                            ${this.#t('dashboardTitle')}\r\n                        </h2>\r\n                        <p class=\"dashboard-subtitle\">${this.#t('dashboardSubtitle')}</p>\r\n                    </div>\r\n                    <uui-button look=\"secondary\" compact @click=\"${this._fetchStats}\">\r\n                        <uui-icon name=\"icon-refresh\"></uui-icon> ${this.#t('dashboardRefresh')}\r\n                    </uui-button>\r\n                </div>\r\n\r\n                <!-- Summary Cards -->\r\n                <div class=\"stats-grid\">\r\n                    <uui-box>\r\n                        <div class=\"stat-card\">\r\n                            <div class=\"stat-icon\" style=\"color: var(--uui-color-primary);\">\r\n                                <uui-icon name=\"icon-documents\"></uui-icon>\r\n                            </div>\r\n                            <div class=\"stat-content\">\r\n                                <span class=\"stat-value\">${stats.totalSnapshotCount.toLocaleString()}</span>\r\n                                <span class=\"stat-label\">${this.#t('dashboardTotalSnapshots')}</span>\r\n                            </div>\r\n                        </div>\r\n                    </uui-box>\r\n                    <uui-box>\r\n                        <div class=\"stat-card\">\r\n                            <div class=\"stat-icon\" style=\"color: var(--uui-color-positive);\">\r\n                                <uui-icon name=\"icon-server\"></uui-icon>\r\n                            </div>\r\n                            <div class=\"stat-content\">\r\n                                <span class=\"stat-value\">${stats.totalSizeFormatted}</span>\r\n                                <span class=\"stat-label\">${this.#t('dashboardTotalStorage')}</span>\r\n                            </div>\r\n                        </div>\r\n                    </uui-box>\r\n                    <uui-box>\r\n                        <div class=\"stat-card\">\r\n                            <div class=\"stat-icon\" style=\"color: var(--uui-color-warning);\">\r\n                                <uui-icon name=\"icon-pictures-alt-2\"></uui-icon>\r\n                            </div>\r\n                            <div class=\"stat-content\">\r\n                                <span class=\"stat-value\">${stats.mediaItemCount.toLocaleString()}</span>\r\n                                <span class=\"stat-label\">${this.#t('dashboardMediaItems')}</span>\r\n                            </div>\r\n                        </div>\r\n                    </uui-box>\r\n                    <uui-box>\r\n                        <div class=\"stat-card\">\r\n                            <div class=\"stat-icon\" style=\"color: var(--uui-color-text-alt);\">\r\n                                <uui-icon name=\"icon-chart\"></uui-icon>\r\n                            </div>\r\n                            <div class=\"stat-content\">\r\n                                <span class=\"stat-value\">\r\n                                    ${stats.totalSnapshotCount > 0 && stats.mediaItemCount > 0\r\n                                        ? (stats.totalSnapshotCount / stats.mediaItemCount).toFixed(1)\r\n                                        : '0'}\r\n                                </span>\r\n                                <span class=\"stat-label\">${this.#t('dashboardAvgSnapshots')}</span>\r\n                            </div>\r\n                        </div>\r\n                    </uui-box>\r\n                </div>\r\n\r\n                <!-- Top Consumers -->\r\n                <uui-box headline=\"${this.#t('dashboardTopConsumers')}\">\r\n                    ${stats.topConsumers.length === 0\r\n                        ? html`\r\n                            <div class=\"empty-state\">\r\n                                <uui-icon name=\"icon-folder\" style=\"font-size: 2rem; color: var(--uui-color-text-alt);\"></uui-icon>\r\n                                <p>${this.#t('dashboardNoSnapshots')}</p>\r\n                            </div>\r\n                        `\r\n                        : html`\r\n                            <uui-table>\r\n                                <uui-table-head>\r\n                                    <uui-table-head-cell style=\"width: 40px;\">#</uui-table-head-cell>\r\n                                    <uui-table-head-cell>${this.#t('dashboardMediaItem')}</uui-table-head-cell>\r\n                                    <uui-table-head-cell>${this.#t('snapshots')}</uui-table-head-cell>\r\n                                    <uui-table-head-cell>${this.#t('dashboardStorageUsed')}</uui-table-head-cell>\r\n                                    <uui-table-head-cell>${this.#t('dashboardLatestSnapshot')}</uui-table-head-cell>\r\n                                    <uui-table-head-cell>${this.#t('dashboardOldestSnapshot')}</uui-table-head-cell>\r\n                                </uui-table-head>\r\n                                ${stats.topConsumers.map((folder, index) => html`\r\n                                    <uui-table-row>\r\n                                        <uui-table-cell>\r\n                                            <span class=\"rank-badge\">${index + 1}</span>\r\n                                        </uui-table-cell>\r\n                                        <uui-table-cell>${this._renderFolderCell(folder)}</uui-table-cell>\r\n                                        <uui-table-cell>${folder.snapshotCount}</uui-table-cell>\r\n                                        <uui-table-cell>${folder.totalSizeFormatted}</uui-table-cell>\r\n                                        <uui-table-cell>${this._formatDate(folder.latestSnapshotDate)}</uui-table-cell>\r\n                                        <uui-table-cell>${this._formatDate(folder.oldestSnapshotDate)}</uui-table-cell>\r\n                                    </uui-table-row>\r\n                                `)}\r\n                            </uui-table>\r\n                        `\r\n                    }\r\n                </uui-box>\r\n\r\n                <!-- Current Settings -->\r\n                <uui-box headline=\"${this.#t('dashboardActiveConfig')}\">\r\n                    <div class=\"settings-grid\">\r\n                        <div class=\"setting-item\">\r\n                            <span class=\"setting-label\">${this.#t('dashboardMaxPerMedia')}</span>\r\n                            <span class=\"setting-value\">\r\n                                ${stats.settings.maxSnapshotsPerMedia === 0\r\n                                    ? html`<uui-tag look=\"secondary\">${this.#t('dashboardUnlimited')}</uui-tag>`\r\n                                    : stats.settings.maxSnapshotsPerMedia}\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"setting-item\">\r\n                            <span class=\"setting-label\">${this.#t('dashboardMaxAge')}</span>\r\n                            <span class=\"setting-value\">\r\n                                ${stats.settings.maxSnapshotAgeDays === 0\r\n                                    ? html`<uui-tag look=\"secondary\">${this.#t('dashboardNeverExpires')}</uui-tag>`\r\n                                    : `${stats.settings.maxSnapshotAgeDays} ${this.#t('dashboardDays')}`}\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"setting-item\">\r\n                            <span class=\"setting-label\">${this.#t('dashboardAutoCleanup')}</span>\r\n                            <span class=\"setting-value\">\r\n                                ${stats.settings.enableAutomaticCleanup\r\n                                    ? html`<uui-tag look=\"primary\" color=\"positive\">${this.#t('dashboardEnabled')}</uui-tag>`\r\n                                    : html`<uui-tag look=\"primary\" color=\"danger\">${this.#t('dashboardDisabled')}</uui-tag>`}\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"setting-item\">\r\n                            <span class=\"setting-label\">${this.#t('dashboardSasExpiration')}</span>\r\n                            <span class=\"setting-value\">${hours} ${hours !== 1 ? this.#t('dashboardHours') : this.#t('dashboardHour')}</span>\r\n                        </div>\r\n                        <div class=\"setting-item\">\r\n                            <span class=\"setting-label\">${this.#t('dashboardTrackedTypes')}</span>\r\n                            <span class=\"setting-value setting-value-tags\">\r\n                                ${stats.settings.trackedMediaTypes.map(t => html`\r\n                                    <uui-tag look=\"primary\">${t}</uui-tag>\r\n                                `)}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </uui-box>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    static styles = css`\r\n        :host {\r\n            display: block;\r\n            padding: var(--uui-size-space-5);\r\n        }\r\n\r\n        .dashboard {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: var(--uui-size-space-5);\r\n            max-width: 1200px;\r\n        }\r\n\r\n        .dashboard-loading {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-3);\r\n            padding: var(--uui-size-space-6);\r\n            color: var(--uui-color-text-alt);\r\n            font-size: 1rem;\r\n        }\r\n\r\n        .dashboard-error {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-3);\r\n            color: var(--uui-color-danger);\r\n        }\r\n\r\n        .dashboard-header {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: flex-start;\r\n        }\r\n\r\n        .dashboard-header h2 {\r\n            margin: 0;\r\n            display: flex;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-2);\r\n            font-size: 1.5rem;\r\n        }\r\n\r\n        .dashboard-subtitle {\r\n            margin: var(--uui-size-space-2) 0 0 0;\r\n            color: var(--uui-color-text-alt);\r\n        }\r\n\r\n        /* Summary cards */\r\n        .stats-grid {\r\n            display: grid;\r\n            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));\r\n            gap: var(--uui-size-space-4);\r\n        }\r\n\r\n        .stat-card {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-4);\r\n            padding: var(--uui-size-space-2);\r\n        }\r\n\r\n        .stat-icon {\r\n            font-size: 2rem;\r\n            flex-shrink: 0;\r\n        }\r\n\r\n        .stat-content {\r\n            display: flex;\r\n            flex-direction: column;\r\n        }\r\n\r\n        .stat-value {\r\n            font-size: 1.6rem;\r\n            font-weight: 700;\r\n            line-height: 1.2;\r\n        }\r\n\r\n        .stat-label {\r\n            font-size: 0.85rem;\r\n            color: var(--uui-color-text-alt);\r\n            margin-top: 2px;\r\n        }\r\n\r\n        /* Top consumers table */\r\n        uui-table {\r\n            border: 1px solid var(--uui-color-border);\r\n            border-radius: var(--uui-border-radius);\r\n            background: var(--uui-color-surface);\r\n        }\r\n\r\n        uui-table-head-cell {\r\n            font-weight: bold;\r\n        }\r\n\r\n        .rank-badge {\r\n            display: inline-flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            width: 24px;\r\n            height: 24px;\r\n            border-radius: 50%;\r\n            background: var(--uui-color-surface-alt);\r\n            border: 1px solid var(--uui-color-border);\r\n            font-size: 0.8rem;\r\n            font-weight: 600;\r\n        }\r\n\r\n        .folder-name {\r\n            font-family: monospace;\r\n            font-size: 0.85rem;\r\n            background: var(--uui-color-surface-alt);\r\n            padding: 2px 6px;\r\n            border-radius: 3px;\r\n        }\r\n\r\n        /* Media item link */\r\n        .media-link {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-2);\r\n            color: var(--uui-color-interactive);\r\n            text-decoration: none;\r\n            transition: color 0.2s;\r\n        }\r\n\r\n        .media-link:hover {\r\n            color: var(--uui-color-interactive-emphasis);\r\n            text-decoration: underline;\r\n        }\r\n\r\n        .media-link uui-icon {\r\n            color: var(--uui-color-primary);\r\n            flex-shrink: 0;\r\n        }\r\n\r\n        .media-link-name {\r\n            font-weight: 600;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n            white-space: nowrap;\r\n        }\r\n\r\n        .folder-name-sub {\r\n            font-family: monospace;\r\n            font-size: 0.75rem;\r\n            color: var(--uui-color-text-alt);\r\n            background: var(--uui-color-surface-alt);\r\n            padding: 1px 4px;\r\n            border-radius: 3px;\r\n            flex-shrink: 0;\r\n        }\r\n\r\n        /* Orphaned folder */\r\n        .folder-unresolved {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-2);\r\n        }\r\n\r\n        .empty-state {\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            gap: var(--uui-size-space-3);\r\n            padding: var(--uui-size-space-6);\r\n            color: var(--uui-color-text-alt);\r\n        }\r\n\r\n        /* Settings grid */\r\n        .settings-grid {\r\n            display: grid;\r\n            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\r\n            gap: var(--uui-size-space-4);\r\n        }\r\n\r\n        .setting-item {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: var(--uui-size-space-1);\r\n            padding: var(--uui-size-space-3);\r\n            background: var(--uui-color-surface-alt);\r\n            border-radius: var(--uui-border-radius);\r\n        }\r\n\r\n        .setting-label {\r\n            font-size: 0.8rem;\r\n            color: var(--uui-color-text-alt);\r\n            text-transform: uppercase;\r\n            letter-spacing: 0.5px;\r\n        }\r\n\r\n        .setting-value {\r\n            font-size: 1.1rem;\r\n            font-weight: 600;\r\n        }\r\n\r\n        .setting-value-tags {\r\n            display: flex;\r\n            flex-wrap: wrap;\r\n            gap: 4px;\r\n            font-size: 0.85rem;\r\n        }\r\n\r\n        @media (max-width: 768px) {\r\n            .stats-grid {\r\n                grid-template-columns: repeat(2, 1fr);\r\n            }\r\n            .settings-grid {\r\n                grid-template-columns: 1fr;\r\n            }\r\n            .dashboard-header {\r\n                flex-direction: column;\r\n                gap: var(--uui-size-space-3);\r\n            }\r\n        }\r\n    `;\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'snapshot-dashboard': SnapshotDashboardElement;\r\n    }\r\n}"],"names":["_localize","_SnapshotDashboardElement_instances","t_fn","SnapshotDashboardElement","UmbElementMixin","LitElement","__privateAdd","UmbLocalizationController","UMB_AUTH_CONTEXT","instance","token","__privateMethod","response","error","dateString","folder","href","displayName","html","stats","hours","index","t","key","__privateGet","css","__decorateClass","state","customElement"],"mappings":"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"}